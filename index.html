<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Neural Recon Terminal</title>

    <!-- PWA Meta Tags -->
    <meta name="application-name" content="Neural Recon">
    <meta name="theme-color" content="#050506">
    <meta name="mobile-web-app-capable" content="yes">

    <!-- iOS PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Neural Recon">

    <!-- iOS Icons -->
    <link rel="apple-touch-icon" href="icons/icon-180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180.png">

    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-96.png">

    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div id="briefingOverlay">
        <div class="briefing-modal">
            <div class="briefing-header" id="briefingTitle">Mission Briefing</div>

            <div class="briefing-tabs">
                <div class="briefing-tab active" data-tab="basics">How to Play</div>
                <div class="briefing-tab" data-tab="tips">Pro Tips</div>
            </div>

            <div id="tab-basics" class="briefing-content active">
                <div class="briefing-section">
                    <h3>Goal</h3>
                    <p>Find the hidden path through the grid by placing the missing <span class="theme-walls">walls</span>.</p>
                </div>

                <div class="briefing-section">
                    <h3>Rules</h3>
                    <p>1. The <span class="briefing-tag">numbers</span> on each row/column show how many <span class="theme-walls">walls</span> belong there.</p>
                    <p>2. The path must be <span class="briefing-tag">continuous</span> â€” all path nodes connect.</p>
                    <p>3. <span class="briefing-tag">No 2Ã—2 squares</span> of path nodes allowed (except inside a <span class="theme-vault">vault</span>).</p>
                    <p>4. On larger grids, a <span class="briefing-tag theme-stockpile">Stockpile</span> may appear inside a hidden 3Ã—3 <span class="theme-vault">vault</span> with a single door.</p>
                </div>

                <div class="briefing-section">
                    <h3>Cell Types</h3>
                    <div class="briefing-row">
                        <span class="cell-icon cell-icon-wall"></span>
                        <span class="briefing-row-label"><span class="briefing-tag theme-wall">Wall</span> â€” Click once to place. Blocks the path. Fill in all <span class="theme-walls">walls</span> to finish the puzzle.</span>
                    </div>
                    <div class="briefing-row">
                        <span class="cell-icon cell-icon-path"></span>
                        <span class="briefing-row-label"><span class="briefing-tag theme-path">Path</span> â€” Click twice to place. Marks where the path goes. It is not necessary to fill in all paths to finish the puzzle.</span>
                    </div>
                    <div class="briefing-row">
                        <span class="cell-icon cell-icon-deadend"></span>
                        <span class="briefing-row-label"><span class="briefing-tag theme-deadend">Dead End</span> â€” Fixed on the grid. The path must connect to each of these. Each <span class="theme-deadend">dead end</span> must connect to exactly one path node and 3 wall nodes.</span>
                    </div>
                    <div class="briefing-row">
                        <span class="cell-icon cell-icon-stockpile"></span>
                        <span class="briefing-row-label"><span class="briefing-tag theme-stockpile">Stockpile</span> â€” <span id="stockpileDesc">Located inside a 3Ã—3 vault surrounded by walls with one door. Turns green when the vault is properly sealed.</span></span>
                    </div>
                </div>

                <div class="briefing-section">
                    <h3>Controls</h3>
                    <p>Use the <span class="briefing-tag">Mode</span> buttons to select what to draw:</p>
                    <p><span class="briefing-tag theme-wall">Wall</span> â€” Tap to place <span class="theme-wall">walls</span>, tap <span class="theme-wall">walls</span> to erase</p>
                    <p><span class="briefing-tag theme-path">Path</span> â€” Tap to place paths, tap paths to erase</p>
                    <p><span class="briefing-tag">Erase</span> â€” Tap any cell to clear it</p>
                    <p><span class="briefing-tag">Auto</span> â€” Context-aware: tap empty for <span class="theme-wall">wall</span>, tap <span class="theme-wall">wall</span> for path, tap path to erase. Drag from <span class="theme-deadends">dead ends</span> or <span class="theme-stockpile">data caches</span> to draw paths. Tap on <span class="theme-deadends">dead ends</span> to auto-fill <span class="theme-walls">walls</span> and paths when able.</p>
                </div>

                <div class="briefing-section">
                    <h3>Layers (Advanced)</h3>
                    <p>Use <span class="briefing-tag theme-fork">Fork</span> to create a new layer for experimenting.</p>
                    <p>Use <span class="briefing-tag theme-commit">Commit</span> to merge your changes down, or <span class="briefing-tag theme-discard">Discard</span> to undo.</p>
                </div>
            </div>

            <div id="tab-tips" class="briefing-content">
                <div class="briefing-section">
                    <h3>Tip 1: Tap <span class="theme-deadends">dead ends</span> with One Path or Three <span class="theme-walls">Walls</span></h3>
                    <p>When a <span class="theme-deadend">dead end</span> already has one path neighbor, or three <span class="theme-wall">wall</span> neighbors, tap it to auto-fill <span class="theme-walls">walls</span> and paths around it.</p>
                    <div class="tip-example">
                        <div>
                            <div class="tip-grid" style="grid-template-columns: repeat(3, 24px);">
                                <div class="tip-cell"></div>
                                <div class="tip-cell tip-cell-deduced tip-cell-wall"></div>
                                <div class="tip-cell"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-deadend"></div>
                                <div class="tip-cell tip-cell-deduced tip-cell-wall"></div>
                                <div class="tip-cell"></div>
                                <div class="tip-cell tip-cell-deduced tip-cell-wall"></div>
                                <div class="tip-cell"></div>
                            </div>
                        </div>
                        <div class="tip-explanation">
                            The <span class="theme-deadend">dead end</span> already connects left. Tapping it fills the other 3 neighbors with <span class="theme-walls">walls</span> automatically.
                        </div>
                    </div>
                </div>

                <div class="briefing-section">
                    <h3>Tip 2: Tap Green Numbers</h3>
                    <p>When a row/column has the correct <span class="theme-wall">wall</span> count (green number), tap it to fill remaining cells with path nodes.</p>
                    <div class="tip-example">
                        <div>
                            <div style="display: flex; align-items: center; gap: 4px;">
                                <div class="tip-label" style="color: var(--neon-green); font-weight: bold;">2</div>
                                <div class="tip-grid" style="grid-template-columns: repeat(4, 24px);">
                                    <div class="tip-cell tip-cell-wall"></div>
                                    <div class="tip-cell tip-cell-deduced"></div>
                                    <div class="tip-cell tip-cell-wall"></div>
                                    <div class="tip-cell tip-cell-deduced"></div>
                                </div>
                            </div>
                        </div>
                        <div class="tip-explanation">
                            This row needs 2 <span class="theme-walls">walls</span> and already has 2. Tap the green "2" to fill empty cells with path nodes.
                        </div>
                    </div>
                </div>

                <div class="briefing-section">
                    <h3>Tip 3: Use <span class="theme-fork">Fork</span> for Guessing</h3>
                    <p>Stuck? Use <span class="briefing-tag theme-fork">Fork</span> to try a guess. If it leads to a contradiction, <span class="briefing-tag theme-discard">Discard</span> and try the opposite.</p>
                </div>

                <div class="briefing-section">
                    <h3>Tip 4: <span class="theme-vault">Vault</span> Layout</h3>
                    <p id="vaultDesc">On 6Ã—6+ grids, look for a 3Ã—3 vault with 11 walls around it and 1 door. The vault contains a <span class="briefing-tag theme-stockpile">Stockpile</span> somewhere inside.</p>
                    <div class="tip-example">
                        <div>
                            <div class="tip-grid" style="grid-template-columns: repeat(5, 24px);">
                                <div class="tip-cell"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell tip-cell-stockpile"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell tip-cell-deduced tip-cell-path"></div>
                                <div class="tip-cell tip-cell-wall"></div>
                                <div class="tip-cell"></div>
                            </div>
                        </div>
                        <div class="tip-explanation">
                            The <span class="theme-vault">vault</span> has 11 <span class="theme-walls">walls</span> surrounding it with a single door. This example shows the door at the bottom, but it can be in any <span class="theme-wall">wall</span>. The 3Ã—3 interior is empty other than the <span class="theme-stockpile">stockpile</span> cell.
                        </div>
                    </div>
                </div>

                <div class="briefing-section" style="margin-top: 24px; padding-top: 16px; border-top: 1px solid #333;">
                    <h3 style="color: var(--neon-magenta);">Expert Tips</h3>
                </div>

                <div class="briefing-section">
                    <h3>Tip 5: Don't Create Unwanted <span class="theme-deadends">dead ends</span></h3>
                    <p>If a row needs only 1 more <span class="theme-wall">wall</span>, it can't be placed where it would trap an empty cell with 3 <span class="theme-walls">walls</span>.</p>
                    <div class="tip-example">
                        <div>
                            <div style="display: flex; flex-direction: column; gap: 2px;">
                                <div style="display: flex; align-items: center; gap: 4px;">
                                    <div class="tip-label" style="color: var(--neon-green); width: 16px;">2</div>
                                    <div class="tip-grid" style="grid-template-columns: repeat(5, 24px);">
                                        <div class="tip-cell tip-cell-maybe" style="font-size:10px; color:#f88;">X</div>
                                        <div class="tip-cell" style="font-size:9px; color:#888;">trap</div>
                                        <div class="tip-cell tip-cell-wall"></div>
                                        <div class="tip-cell"></div>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 4px;">
                                    <div class="tip-label" style="color: #888; width: 16px;">3</div>
                                    <div class="tip-grid" style="grid-template-columns: repeat(5, 24px);">
                                        <div class="tip-cell"></div>
                                        <div class="tip-cell tip-cell-wall"></div>
                                        <div class="tip-cell tip-cell-maybe"></div>
                                        <div class="tip-cell tip-cell-maybe"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tip-explanation">
                            The top row needs only 1 more <span class="theme-wall">wall</span>. The <span class="theme-wall">wall</span> cannot go at X since that would create a cell surrounded by 3 walls with no <span class="theme-deadend">dead end</span> node. X must therefore be part of the path. The bottom row still needs 2 more <span class="theme-walls">walls</span>, so this technique doesn't apply there.
                        </div>
                    </div>
                </div>

                <div class="briefing-section">
                    <h3>Tip 6: Avoid 2Ã—2 Path Squares</h3>
                    <p>If placing a path would create a 2Ã—2 square of paths, that cell must be a <span class="theme-wall">wall</span>.</p>
                    <div class="tip-example">
                        <div>
                            <div class="tip-grid" style="grid-template-columns: repeat(3, 24px);">
                                <div class="tip-cell"></div>
                                <div class="tip-cell"></div>
                                <div class="tip-cell"></div>
                                <div class="tip-cell"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell"></div>
                                <div class="tip-cell tip-cell-path"></div>
                                <div class="tip-cell tip-cell-deduced tip-cell-wall"></div>
                            </div>
                        </div>
                        <div class="tip-explanation">
                            Three corners of a 2Ã—2 are paths. The fourth <em>must</em> be a <span class="theme-wall">wall</span> to avoid a 2Ã—2 path square.
                        </div>
                    </div>
                </div>

                <div class="briefing-section">
                    <h3>Tip 7: <span class="theme-deadend">Dead End</span> with One <span class="theme-wall">Wall</span> Left</h3>
                    <p>If a row needs exactly 1 more <span class="theme-wall">wall</span> and has a <span class="theme-deadend">dead end</span> with no <span class="theme-walls">walls</span> on either side, deduce the perpendicular <span class="theme-walls">walls</span> and the rest of the row.</p>
                    <div class="tip-example">
                        <div>
                            <div style="display: flex; flex-direction: column; gap: 2px;">
                                <div style="display: flex; align-items: center; gap: 4px;">
                                    <div class="tip-label" style="width: 16px;"></div>
                                    <div class="tip-grid" style="grid-template-columns: repeat(5, 24px);">
                                        <div class="tip-cell"></div>
                                        <div class="tip-cell"></div>
                                        <div class="tip-cell tip-cell-deduced tip-cell-wall"></div>
                                        <div class="tip-cell"></div>
                                        <div class="tip-cell"></div>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 4px;">
                                    <div class="tip-label" style="color: #888; width: 16px;">1</div>
                                    <div class="tip-grid" style="grid-template-columns: repeat(5, 24px);">
                                        <div class="tip-cell tip-cell-deduced tip-cell-path"></div>
                                        <div class="tip-cell tip-cell-maybe" style="font-size:9px; color:#fa0;">X</div>
                                        <div class="tip-cell tip-cell-deadend"></div>
                                        <div class="tip-cell tip-cell-maybe" style="font-size:9px; color:#fa0;">X</div>
                                        <div class="tip-cell tip-cell-deduced tip-cell-path"></div>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 4px;">
                                    <div class="tip-label" style="width: 16px;"></div>
                                    <div class="tip-grid" style="grid-template-columns: repeat(5, 24px);">
                                        <div class="tip-cell"></div>
                                        <div class="tip-cell"></div>
                                        <div class="tip-cell tip-cell-deduced tip-cell-wall"></div>
                                        <div class="tip-cell"></div>
                                        <div class="tip-cell"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tip-explanation">
                            This row needs 1 <span class="theme-wall">wall</span>. Since a <span class="theme-deadend">dead end</span> is surrounded by 3 <span class="theme-walls">walls</span>, the row's only <span class="theme-wall">wall</span> must be one of the two cells to the left or right of the <span class="theme-deadend">dead end</span> (X). Even though it cannot be deduced which of the two is the <span class="theme-wall">wall</span> and which is part of the path, it is known that the two cells above and below must be <span class="theme-walls">walls</span>, and also all other cells in the row are also part of the path.
                        </div>
                    </div>
                </div>
            </div>

            <div class="briefing-footer">
                <label class="briefing-checkbox-label">
                    <input type="checkbox" id="dontShowBriefingCheckbox">
                    <span>Don't show on startup</span>
                </label>
                <button id="closeBriefingBtn" class="cyber-btn" style="padding: 10px 40px; font-size: 14px;">Got It</button>
            </div>
        </div>
    </div>

    <div class="header-strip">
        <button id="menuBtn" class="cyber-btn btn-menu" title="Menu">â˜°</button>
        <select id="gridSizeSelect" class="size-select">
            <option value="4">4x4</option>
            <option value="5">5x5</option>
            <option value="6">6x6</option>
            <option value="7">7x7</option>
            <option value="8" selected>8x8</option>
        </select>
        <button id="newMazeBtn" class="cyber-btn">Initialize</button>
        <button id="undoBtn" class="cyber-btn" disabled>Undo</button>
        <button id="hintBtn" class="cyber-btn btn-hint" title="Get Hint">?</button>
        <div class="btn-group-nowrap">
            <button id="addLayerBtn" class="cyber-btn btn-action">Fork</button>
            <button id="commitBtn" class="cyber-btn">Commit</button>
            <button id="discardBtn" class="cyber-btn btn-kill">Abort</button>
            <div class="layer-indicator">
                <span id="layerName" class="layer-name">Root</span>
            </div>
        </div>
    </div>

    <!-- Slide-in Menu -->
    <div id="menuOverlay" class="menu-overlay">
        <div id="slideMenu" class="slide-menu">
            <div class="menu-header">
                <span class="menu-title">MENU</span>
                <button id="menuCloseBtn" class="menu-close-btn">âœ•</button>
            </div>
            <div class="menu-items">
                <button id="briefingBtn" class="menu-item">
                    <span class="menu-item-label">Briefing</span>
                </button>
                <button id="statsBtn" class="menu-item">
                    <span class="menu-item-label">Stats</span>
                </button>
                <div class="menu-divider"></div>

                <!-- Assist Mode Expandable Menu -->
                <div class="menu-expand-section">
                    <button id="assistModeBtn" class="menu-item menu-toggle menu-expand-header">
                        <span class="menu-expand-icon">â–¶</span>
                        <span class="menu-item-label">Assist Mode</span>
                        <span id="assistModeState" class="menu-toggle-state">ON</span>
                    </button>
                    <div id="assistModeContent" class="menu-expand-content">
                        <!-- Visual Hints Sub-section -->
                        <div class="menu-expand-section nested">
                            <button id="visualHintsBtn" class="menu-item menu-toggle menu-expand-header">
                                <span class="menu-expand-icon">â–¶</span>
                                <span class="menu-item-label">Visual Hints</span>
                                <span id="visualHintsState" class="menu-toggle-state">ON</span>
                            </button>
                            <div id="visualHintsContent" class="menu-expand-content">
                                <button id="errorIndicatorsBtn" class="menu-item menu-toggle nested-item">
                                    <span class="menu-item-label">Error Indicators</span>
                                    <span id="errorIndicatorsState" class="menu-toggle-state">ON</span>
                                </button>
                                <button id="progressIndicatorsBtn" class="menu-item menu-toggle nested-item">
                                    <span class="menu-item-label">Progress Indicators</span>
                                    <span id="progressIndicatorsState" class="menu-toggle-state">ON</span>
                                </button>
                            </div>
                        </div>
                        <!-- Auto-fill Sub-section -->
                        <div class="menu-expand-section nested">
                            <button id="autoFillBtn" class="menu-item menu-toggle menu-expand-header">
                                <span class="menu-expand-icon">â–¶</span>
                                <span class="menu-item-label">Auto-fill</span>
                                <span id="autoFillState" class="menu-toggle-state">ON</span>
                            </button>
                            <div id="autoFillContent" class="menu-expand-content">
                                <button id="deadEndFillBtn" class="menu-item menu-toggle nested-item">
                                    <span class="menu-item-label">Dead-end Fill</span>
                                    <span id="deadEndFillState" class="menu-toggle-state">ON</span>
                                </button>
                                <button id="wallCompletionBtn" class="menu-item menu-toggle nested-item">
                                    <span class="menu-item-label">Wall Completion</span>
                                    <span id="wallCompletionState" class="menu-toggle-state">ON</span>
                                </button>
                                <button id="pathCompletionBtn" class="menu-item menu-toggle nested-item">
                                    <span class="menu-item-label">Path Completion</span>
                                    <span id="pathCompletionState" class="menu-toggle-state">ON</span>
                                </button>
                            </div>
                        </div>
                        <!-- Decrypt Overlay -->
                        <button id="decryptToggleBtn" class="menu-item menu-toggle nested-item">
                            <span class="menu-item-label">Decrypt Overlay</span>
                            <span id="decryptToggleState" class="menu-toggle-state off-state">OFF</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="menu-footer">
                <div class="menu-divider"></div>
                <!-- Seed Section -->
                <div class="seed-section">
                    <div class="seed-current">
                        <span class="seed-label">Seed:</span>
                        <span id="currentSeed" class="seed-value">------</span>
                        <button id="copySeedBtn" class="seed-copy-btn" title="Copy seed">ðŸ“‹</button>
                    </div>
                    <div class="seed-history">
                        <span class="seed-label">Recent:</span>
                        <div id="seedHistory" class="seed-history-list"></div>
                    </div>
                    <div class="seed-input-row">
                        <input type="text" id="seedInput" class="seed-input" placeholder="Enter seed..." maxlength="12">
                        <button id="playSeedBtn" class="seed-play-btn">Play</button>
                    </div>
                </div>
                <div class="menu-divider"></div>
                <div class="menu-audio-row">
                    <button id="soundToggleBtn" class="menu-audio-btn" title="Sound Effects">
                        <span id="soundIcon">ðŸ”Š</span>
                    </button>
                    <button id="musicToggleBtn" class="menu-audio-btn" title="Music">
                        <span id="musicIcon">ðŸŽµ</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="mode-strip">
        <button id="modeWall" class="mode-btn" data-mode="wall">
            <span class="mode-icon mode-icon-wall"></span>
            <span>Wall</span>
        </button>
        <button id="modePath" class="mode-btn" data-mode="path">
            <span class="mode-icon mode-icon-path"></span>
            <span>Path</span>
        </button>
        <button id="modeErase" class="mode-btn" data-mode="erase">
            <span class="mode-icon mode-icon-erase"></span>
            <span>Erase</span>
        </button>
        <button id="modeSmart" class="mode-btn active" data-mode="smart">
            <span class="mode-icon mode-icon-wall"></span>
            <span class="mode-icon mode-icon-path"></span>
            <span class="mode-icon mode-icon-erase"></span>
            <span>Auto</span>
        </button>
    </div>

    <div class="grid-wrapper">
        <div></div><div id="colLabels" class="label-container-col"></div><div></div>
        <div id="rowLabels" class="label-container-row"></div>
        <div id="mainGrid" class="cyber-grid">
            <div id="victoryOverlay">
                <div class="scan-lines"></div>
                <div class="victory-content">
                    <div class="victory-title">NEURAL LINK RESTORED</div>
                    <div id="technoBabble" class="techno-babble"></div>
                    <div class="victory-stats">
                        <div class="stat-row">
                            <span class="stat-label">Sync Duration:</span>
                            <span id="statTime" class="stat-value">00:00</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Node Operations:</span>
                            <span id="statMoves" class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Consecutive Links:</span>
                            <span id="statStreak" class="stat-value">1</span>
                        </div>
                    </div>
                    <button id="nextLevelBtn" class="cyber-btn btn-action next-level-btn">Initialize Next Sequence</button>
                </div>
            </div>
            <!-- Hint Toast -->
            <div id="hintToast" class="hint-toast">
                <div class="hint-toast-content">
                    <span id="hintMessage" class="hint-toast-message"></span>
                </div>
            </div>
        </div>
        <div class="grid-spacer"></div>
    </div>

    <!-- Stats Dialog -->
    <div id="statsOverlay" class="stats-overlay">
        <div class="stats-modal">
            <div class="stats-title">OPERATOR METRICS</div>
            <div class="stats-content">
                <div class="stat-row">
                    <span class="stat-label">Total Puzzles Solved:</span>
                    <span id="statTotalWins" class="stat-value">0</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Total Time Played:</span>
                    <span id="statTotalTime" class="stat-value">00:00:00</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Total Moves:</span>
                    <span id="statTotalMoves" class="stat-value">0</span>
                </div>
                <div class="stats-section-title">By Grid Size</div>
                <div class="stats-size-tabs">
                    <button class="stats-tab active" data-size="4">4Ã—4</button>
                    <button class="stats-tab" data-size="5">5Ã—5</button>
                    <button class="stats-tab" data-size="6">6Ã—6</button>
                    <button class="stats-tab" data-size="7">7Ã—7</button>
                    <button class="stats-tab" data-size="8">8Ã—8</button>
                </div>
                <div id="statsSizeContent" class="stats-size-content">
                    <div class="stat-row">
                        <span class="stat-label">Puzzles Solved:</span>
                        <span id="statSizeWins" class="stat-value">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Best Streak:</span>
                        <span id="statSizeStreak" class="stat-value">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Fastest Time:</span>
                        <span id="statSizeFastest" class="stat-value">--:--</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Fewest Moves:</span>
                        <span id="statSizeMoves" class="stat-value">--</span>
                    </div>
                </div>
            </div>
            <div class="stats-buttons">
                <button id="statsCloseBtn" class="cyber-btn">Dismiss</button>
                <button id="statsClearBtn" class="cyber-btn btn-kill">Clear Stats</button>
            </div>
        </div>
    </div>

    <!-- Clear Stats Confirm Dialog -->
    <dialog id="clearStatsDialog" class="confirm-dialog">
        <div class="confirm-dialog-content">
            <div class="confirm-dialog-title">CONFIRM DATA PURGE</div>
            <p class="confirm-dialog-message">Clear all operator metrics? This action cannot be undone.</p>
            <div class="confirm-dialog-buttons">
                <button id="clearStatsCancelBtn" class="cyber-btn">Cancel</button>
                <button id="clearStatsConfirmBtn" class="cyber-btn btn-kill">Clear Stats</button>
            </div>
        </div>
    </dialog>

    <!-- Reset Puzzle Confirm Dialog -->
    <dialog id="resetPuzzleDialog" class="confirm-dialog">
        <div class="confirm-dialog-content">
            <div class="confirm-dialog-title">CONFIRM INITIALIZATION</div>
            <p class="confirm-dialog-message">Discard progress and start a new puzzle?</p>
            <div class="confirm-dialog-buttons">
                <button id="resetPuzzleCancelBtn" class="cyber-btn">Cancel</button>
                <button id="resetPuzzleConfirmBtn" class="cyber-btn btn-kill">Initialize</button>
            </div>
        </div>
    </dialog>

    <!-- Theme System -->
    <script src="themes/theme-base.js"></script>
    <script src="themes/theme-manager.js"></script>
    <script src="themes/theme-cyberpunk.js"></script>

    <script src="game.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then((registration) => {
                        console.log('ServiceWorker registered:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>

